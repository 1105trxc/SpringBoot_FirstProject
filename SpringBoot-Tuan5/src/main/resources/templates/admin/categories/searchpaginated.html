<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layout-admin.html}">
<section class="row" layout:fragment="content">
	<div class="col-12 mt-4">
		<div class="card shadow-sm">
			<div
				class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
				<span><i class="fa fa-list"></i> List Category</span> <a
					class="btn btn-success btn-sm" th:href="@{/admin/categories/add}">
					<i class="fa fa-plus"></i> Add New Category
				</a>
			</div>
			<div class="card-body">
				<!-- Hiển thông báo -->
				<div th:if="${message != null}"
					class="alert alert-success alert-dismissible fade show"
					role="alert">
					<span th:text="${message}"></span>
					<button type="button" class="btn-close" data-bs-dismiss="alert"
						aria-label="Close"></button>
				</div>
				<!-- Tìm kiếm -->
				<form th:action="@{/admin/categories/searchpaginated}"
					class="row mb-3 g-3 align-items-center">
					<div class="col-auto">
						<input type="text" class="form-control" name="name" id="name"
							placeholder="Nhập từ khóa để tìm" th:value="${name}">
					</div>
					<div class="col-auto">
						<button class="btn btn-outline-primary">
							<i class="fa fa-search"></i> Search
						</button>
					</div>
					<div class="col ms-auto">
						<div class="float-end">
							<label for="size" class="form-label me-2">Page size:</label> <select
								class="form-select d-inline-block w-auto" name="size" id="size"
								onchange="this.form.submit()">
								<option th:selected="${categoryPage.size == 3}" value="3">3</option>
								<option th:selected="${categoryPage.size == 5}" value="5">5</option>
								<option th:selected="${categoryPage.size == 10}" value="10">10</option>
								<option th:selected="${categoryPage.size == 15}" value="15">15</option>
								<option th:selected="${categoryPage.size == 20}" value="20">20</option>
							</select>
						</div>
					</div>
				</form>
				<!-- Bảng hiển thị category -->
				<div class="table-responsive">
					<table th:if="${categoryPage.hasContent()}"
						class="table table-hover table-striped align-middle">
						<thead class="table-primary">
							<tr>
								<th scope="col">#</th>
								<th scope="col">Category Name</th>
								<th scope="col" class="text-center">Action</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="category, iStat : ${categoryPage.content}">
								<td th:text="${category.categoryId}"></td>
								<td th:text="${category.categoryName}"></td>
								<td class="text-center"><a
									th:href="@{'/admin/categories/view/' + ${category.categoryId}}"
									class="btn btn-info btn-sm me-1" title="View"> <i
										class="fa fa-eye"></i>
								</a> <a
									th:href="@{'/admin/categories/edit/' + ${category.categoryId}}"
									class="btn btn-warning btn-sm me-1" title="Edit"> <i
										class="fa fa-edit"></i>
								</a>
									<button type="button" class="btn btn-danger btn-sm"
										th:data-id="${category.categoryId}"
										th:data-name="${category.categoryName}"
										onclick="showconfirmation(this.getAttribute('data-id'),this.getAttribute('data-name'))"
										title="Delete">
										<i class="fa fa-trash"></i>
									</button></td>
							</tr>
						</tbody>
					</table>
					<div th:unless="${categoryPage.hasContent()}"
						class="alert alert-info mt-3">Không có dữ liệu để hiển thị.
					</div>
				</div>
				<!-- Pagination -->
				<nav aria-label="Page navigation"
					th:if="${categoryPage.totalPages > 0}" class="mt-3">
					<ul class="pagination justify-content-center">
						<li
							th:class="${1 == categoryPage.number + 1} ? 'page-item active' : 'page-item'">
							<a
							th:href="@{/admin/categories/searchpaginated(name=${name},size=${categoryPage.size},page=1)}"
							class="page-link">First</a>
						</li>
						<li class="page-item" th:each="pageNumber : ${pageNumbers}"
							th:class="${pageNumber == categoryPage.number + 1} ? 'page-item active' : 'page-item'">
							<a
							th:href="@{/admin/categories/searchpaginated(name=${name},size=${categoryPage.size},page=${pageNumber})}"
							class="page-link" th:text="${pageNumber}"></a>
						</li>
						<li
							th:class="${categoryPage.totalPages == categoryPage.number + 1} ? 'page-item active' : 'page-item'">
							<a
							th:href="@{/admin/categories/searchpaginated(name=${name},size=${categoryPage.size},page=${categoryPage.totalPages})}"
							class="page-link">Last</a>
						</li>
					</ul>
				</nav>
				<!-- Modal xác nhận xóa -->
				<div class="modal fade" id="confirmationId" tabindex="-1"
					aria-labelledby="confirmationLabel" aria-hidden="true">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header bg-danger text-white">
								<h5 class="modal-title" id="confirmationLabel">
									<i class="fa fa-exclamation-circle"></i> Xác nhận xóa
								</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body">
								Bạn có chắc chắn muốn xóa <b><span id="productName"></span></b>?
							</div>
							<div class="modal-footer">
								<a id="yesOption" type="button" class="btn btn-danger">Yes</a>
								<button type="button" class="btn btn-secondary"
									data-bs-dismiss="modal">No</button>
							</div>
						</div>
					</div>
				</div>
				<script type="text/javascript">
					function showconfirmation(id, name) {
						$('#productName').text(name);
						$('#yesOption').attr('href',
								'/admin/categories/delete2/' + id);
						$('#confirmationId').modal('show');
					}
				</script>
			</div>
		</div>
	</div>
</section>
</html>